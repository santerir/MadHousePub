ExtensionDropdown=function(a){var l=$(a.body),n=a.getElementById("items"),s=a.getElementById("searchResults"),r=a.getElementById("recentSites"),i=a.getElementById("favoriteSites"),c=a.getElementById("identitiesMenuItem"),o=a.getElementById("matchingSitesTopLevel"),t=a.getElementById("matchingSites"),p=a.getElementById("addCustomItems"),u=$("#panelContainer"),d=$("#topLevelContainer"),m=$("#allMatchingSitesMenuItem"),e=a.getElementById("allMatchingSitesItems"),g=$("#vaultMenuItem"),f=$("#addOmariaItems"),b=$("#allItems"),v=$("#groupLabel"),h=$("#backButton"),P=$("#debugconsole"),_=$("#wifiExportMenuItem"),y=$("#matchingSitesMenuItem"),E=$("#recentSitesMenuItem"),I=$("#favoriteSitesMenuItem"),L=$(".new"),x=$("#container"),S=$("#innerWrapper"),w=$("#searchInput"),T=$("#applicationsMenuItem"),C=$("#logoContainer"),k=$("#logoPartner"),M=null,D=!1,A=null,F=null,B=null,O=null,N=null,R=365,U=457,z,H=function(){var e=bg.get("lploggedin")?R:U,t=u.is(":visible")&&u.outerHeight()>S.outerHeight()?u.outerHeight():S.outerHeight()<e?e:S.outerHeight(),n=u.is(":visible")?u.outerWidth()+S.outerWidth():S.outerWidth();LPPlatform.setDropdownPopoverSize(t,n)},V=null,G=null,K=null,Y=null,W=null,j=null,Z=null,q=null,X=null,Q=null,J=null,ee=null,te=null,ne=!1,ie=!1,oe=!1,ae=!1,se=!1,re={},le=null,ce={},pe=[],ue={},de=function(e){if(v.empty(),e){var t=e.getName(),n=(t=t.replace(/\\/g," \\ ")).indexOf("\\",t.length/2);if(-1===n&&(n=t.lastIndexOf("\\")),0<n){var i=LPTools.createElement("div","textOverflowContainer groupLabel");i.appendChild(LPTools.createElement("span",null,t.substring(0,n))),v.append(LPTools.createElement("span","textTail","Â "+t.substring(n))),v.append(i),LPTools.setupMiddleEllipsis(v)}else v.append(LPTools.createElement("span","groupLabel",t));v.find(".groupLabel").attr("title",e.toString())}},me,ge;ue.GroupState=function(t){var n=LPTools.getNavIndex();this.pop=function(e){t.rebuildItems(null,e),e&&LPTools.setNavIndex(n),de(t._model)}},ue.SearchState=function(){var e=new ue.CSSState("searchItem",{restoreKeyboardNav:!1});this.pop=function(){Be(),e.pop()}},ue.TopLevelMatchingSitesState=function(e){var t=new ue.CSSState("matchingSites"),n=new ue.GroupState(e);this.pop=function(){n.pop(),t.pop()}},ue.CSSState=(me=l.attr("class"),ge=function(e){l.removeClass(me),l.addClass(e),me=e},function(e,t){var n=me;if(ge(e),LPTools.getOption(t,"applyKeyboardNav",!0)){var i=LPTools.getOption(t,"selectFirst",!1);LPTools.addKeyBoardNavigation($(".extensionMenuItem:visible"),{selectFirst:i})}this.pop=function(){de(null),ge(n),LPTools.getOption(t,"restoreKeyboardNav",!0)&&LPTools.addKeyBoardNavigation($(".extensionMenuItem:visible"),{displayItems:0===pe.length&&te?te.getItems():null}),t&&"function"==typeof t.onPop&&t.onPop()}});var fe=function(){LPTools.parseUserSpecificMenu(a.getElementById("mainMenu"),LPProxy.getAccountClass()),LPProxy.isEnterpriseUser()&&$("#specialOfferMenuItem").hide(),$("#username, #optionsMenuUserName, #optionsViewUserName").text(bg.get("g_username"))},be=function(){$("#container").LP_show(),_e();var e=bg.get("LPContentScriptFeatures").ziggy,t=bg.get("LPContentScriptFeatures").omaria,n=bg.get("LPContentScriptFeatures").site_feedback&&!(bg.get("g_isedge")||bg.get("g_issafari_appext")),i=bg.get("LPContentScriptFeatures").site_feedback_new_badge&&n;ExtensionLicenseExpiration.initialize(),"Enterprise Admin"!==(N=LPProxy.getAccountClass())&&"Teams Admin"!==N||l.addClass("admin"),A=bg.get("g_premium_trial_exp_days"),F=bg.get("g_company_trial_exp_days"),B=bg.get("g_company_license_exp_days"),O=bg.get("g_company_renewalstatus"),M={isZiggySet:e,isOmarSet:t,showHelpText:e};var o=function(){bg.get_method_async(function(e){z=e}),ve(),Ce(),t||E.detach().insertBefore("#toolsMenuItem"),$e(M),fe(e),setTimeout(function(){ye()}),nt(),n?i&&!bg.Preferences.get("hasClickedSiteFeedback")&&(L.css("display","flex"),L.append(LPTools.createElement("div",{class:"badge newBadge"},Strings.translateString("NEW")))):$("#siteFeedbackMenuItem").detach(),e||($("#mainMenu").addClass("showIcons"),he()),bg.sendLpImprove("openicondropdown",{show_sites_in_folders:bg.Preferences.get("showAcctsInGroups",!0)?"on":"off"})},a=LPPlatform.getExtensionDropdownDelay();0<=a?setTimeout(o,a):o();var s=bg.getmatchingsites(!1,!0,!1);if(LPFeatures.allowGift()&&(void 0===s||s.length<3)){var r=$("#specialOfferMenuItem");r.show(),r.unbind("click.ad_event").bind("click.ad_event",function(){bg.sendLpImprove("lpgift_ad_clicked"),bg.openURL(LPProxy.getBaseURL()+"gift.php")})}},ve=function(){x.addClass("loading")},he=function(){bg.MigrationBackground.shouldShowMigrationNotification()?u.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({openEvent:"migration_formfill_notification_shown",headerText:"Welcome to the new LastPass Experience!",openEventProps:{version:"welcome",vault_version:"omar"},subHeaderText:"Your vault has been upgraded!",linkText:"Learn more about these changes.",linkUrl:"https://link.lastpass.com/help-new-form-fills",text1:"The final step is to migrate your form fill profiles to their new homes - this process should only take a minute.",text2:"Your form fill information will be unavailable until you complete this step.",buttonText:"Finish the Update",buttonEvent:"migration_formfill_notification_clicked",buttonEventProps:{version:"welcome",vault_version:"omar",action:"migrate"},dialogClasses:"boldText tall",buttonAction:function(){"cr"===z||"ff"===z||"edgecr"===z?(bg.MigrationBackground.setShouldStartMigration(!0),bg.openvault()):(bg.openURL("https://lastpass.com/experience-update"),bg.lpevent("m_lo"),bg.loggedOut(!1,"menu"))}}),Pe()}):bg.get("LPContentScriptFeatures").premium_trial_upgrade_test_emergency_access&&!localStorage.getItem("dropdown_emergency_upsell")?u.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_emergency_upsell",class:"emergencyUpsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:2},imageTop:"icon-secure.png",headerText:"Prepare for the Unexpected",text1:"Make your LastPass account safely available to a trusted family member or friend with emergency access, available in LastPass Premium.",text2:"Buy Premium to get emergency access.",linkText:"Learn more.",linkUrl:"https://support.logmeininc.com/lastpass/help/set-up-and-manage-emergency-access-lp030013",linkEventProps:{version:2,action:3},buttonText:"Buy Premium",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:2,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/premium/payment")},closePanelButton:!0,closePanelEventProps:{version:2,action:2}}),Pe()}):bg.get("LPContentScriptFeatures").premium_trial_upgrade_test_sharing&&!localStorage.getItem("dropdown_sharing_upsell")?u.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_sharing_upsell",class:"sharingUpsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:3},headerText:"Sharing Made Easy",text1:"Never get asked for a password again. Store & share unlimited items with friends and family members as you need to with LastPass Premium.",linkText:"Learn more.",linkUrl:"https://support.logmeininc.com/lastpass/help/use-the-sharing-center-lp020007",linkEventProps:{version:3,action:3},centerImages:["icon-media","icon-bill-accounts","icon-medical"],centerLabels:["Streaming Media","Bill Payments","Medical ID Numbers"],buttonText:"Buy Premium",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:3,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/premium/payment")},closePanelButton:!0,closePanelEventProps:{version:3,action:2}}),Pe()}):bg.get("LPContentScriptFeatures").premium_trial_to_families_test_generic&&!localStorage.getItem("dropdown_premium_trial_families")?u.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_premium_trial_families",class:"emergencyUpsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:4},imageTop:"icon-family.png",headerText:"LastPass for the Entire Family",text1:"All your family's information -- organized, secure and at your fingertips.",text2:"Simple access to shared accounts",text3:"Secure storage for SSN, medical IDs and more",text4:"Six LastPass accounts, all for one low price",linkText:"Learn more.",linkUrl:"https://www.lastpass.com/family-password-manager",linkEventProps:{version:4,action:3},buttonText:"Try Families",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:4,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/families/trial")},closePanelButton:!0,closePanelEventProps:{version:4,action:2}}),Pe()}):bg.get("LPContentScriptFeatures").premium_to_families_test_generic&&!localStorage.getItem("dropdown_premium_families")?u.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_premium_families",class:"emergencyUpsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:4},imageTop:"icon-family.png",headerText:"LastPass for the Entire Family",text1:"All your family's information -- organized, secure and at your fingertips.",text2:"Simple access to shared accounts",text3:"Secure storage for SSN, medical IDs and more",text4:"Six LastPass accounts, all for $48 per year",linkText:"Learn more.",linkUrl:"https://www.lastpass.com/family-password-manager",linkEventProps:{version:4,action:3},buttonText:"Try Families",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:4,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/families/trial")},closePanelButton:!0,closePanelEventProps:{version:4,action:2}}),Pe()}):bg.get("LPContentScriptFeatures").free_to_premium_ad_test_generic&&!localStorage.getItem("dropdown_free_premium_generic_upsell")?u.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_free_premium_generic_upsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:1},imageCenter:"premium.svg",headerText:"Control Your Digital Life",subHeaderText:"Take your online security to the next level with LastPass Premium",text2:"Designate an emergency access contact & digital heir",text3:"Share vital passwords with family and friends",text4:"Fast-track yourself to priority tech support",linkText:"Learn more.",linkUrl:"https://support.logmeininc.com/lastpass/help/lastpass-premium-faqs-lp010085",linkEventProps:{version:1,action:3},buttonText:"Upgrade To Premium",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:1,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/premium/payment")},closePanelButton:!0,closePanelEventProps:{version:1,action:2}}),Pe()}):bg.get("LPContentScriptFeatures").free_to_premium_ad_test_sharing&&!localStorage.getItem("dropdown_free_premium_sharing_upsell")?u.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_free_premium_sharing_upsell",class:"sharingUpsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:3},headerText:"Enjoy No Limits on Sharing",text1:"Store & share unlimited items with trusted friends and family with LastPass Premium.",linkText:"Learn more.",linkUrl:"https://support.logmeininc.com/lastpass/help/use-the-sharing-center-lp020007",linkEventProps:{version:3,action:3},centerImages:["icon-bill-accounts","icon-media","icon-medical"],centerLabels:["Cable & Household Bill Accounts","Streaming Media","Medical ID Numbers"],buttonText:"Upgrade to Premium",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:3,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/premium/payment")},closePanelButton:!0,closePanelEventProps:{version:3,action:2}}),Pe()}):ExtensionLicenseExpiration.expiredCompanyStatusCheckerForPanelSize()||ExtensionLicenseExpiration.expiredPremiumStatusCheckerForPanelSize()?Pe():bg.get("g_show_original_language_changed_notification")?u.load("extensionLanguageUpdate.html",function(){ExtensionLanguageUpdate.initialize(),Pe()}):LPProxy.isPremiumTrialUser()?u.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({openEvent:"consumer_test_ad_shown",openEventProps:{version:1},headerText:"Control Your Digital Life",subHeaderText:"Stay secure with LastPass Premium",text1:"Designate an emergency access contact & digital heir",text2:"Share vital passwords with family and friends",text3:"Fast-track yourself to priority tech support",buttonText:"Upgrade To Premium",imageCenter:"premium.svg",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:1},buttonAction:function(){bg.openURL("https://lastpass.com/premium/payment")}}),Pe()}):Pe()},Pe=function(){x.addClass("initialized"),LPTools.addKeyBoardNavigation($(".extensionMenuItem:visible"),{displayItems:te?te.getItems():null}),w.focus(),H()},_e=function(){LPFeatures.updateFeatures({import:!0,noexport:!1,show_notes:!0,hideidentities:!1,show_formfills:!0})},ye=function(){if(LPProxy.initializeModel(),ke(M),Ie(M),!ie&&-1<bg.get("g_local_accts_version")){for(var e in ie=!0,x.removeClass("loading"),ce)ce[e]();var t=w.val();t&&Oe(t)}else setTimeout(ye,15)},Ee=function(e,t){var t=t||{};return LPProxy.getPreference("showAcctsInGroups",!0)&&(e=LPProxy.assignItemsToGroups(e,!1),t.separateFavorites=!0),new Container(e,t)},Ie=function(e){e.isOmarSet?((K=new Container(LPProxy.getAllItems(),$.extend({},e,{omarItems:!0,trackAction:!0}))).setElement(n),J=new Container(LPProxy.getCustomNoteTemplates().map(function(e){return new AddCustomItemDisplay(e)}),$.extend({},e,{additionalItemClasses:"addOmariaItem",autoExpandSingleItem:!1,value:"Custom"})),Se(J.getItemCount()),we()):((Y=Ee(LPProxy.getSites(),e)).setElement(n),(j=Ee(LPProxy.getNotes(),e)).setElement(n),(Z=new Container(LPProxy.getFormFills(),e)).setElement(n),(q=new Container(LPProxy.getApplications(),e)).setElement(n)),ExtensionLicenseExpiration.premiumTrialExpiringStatusChecker()||ExtensionLicenseExpiration.premiumTrialExpiredStatusChecker()?ExtensionLicenseExpiration.showExpiration(N,"trial",A):ExtensionLicenseExpiration.companyTrialExpiringStatusChecker()||ExtensionLicenseExpiration.companyTrialExpiredStatusChecker()?ExtensionLicenseExpiration.showExpiration(N,"trial",F):(ExtensionLicenseExpiration.companyLicenseExpiredStatusChecker()||ExtensionLicenseExpiration.companyLicenseExpiringStatusChecker())&&ExtensionLicenseExpiration.showExpiration(N,"normal",B,O),Q=new Container(LPProxy.getAllItems(),$.extend({},e,{moreOptionsState:ue.SearchState,moreOptionsCallback:H})),"Enterprise Admin"===N||"Enterprise Role User"===N||"Teams Admin"===N||"Teams Role User"===N?($(".feature-omaria #optionsViewLogoutMenuItem, .feature-omaria #optionsMenuItemEnt").show(),$(".feature-omaria #logoutMenuItem, .feature-omaria #optionsMenuItem").hide()):($(".feature-omaria #optionsViewLogoutMenuItem, .feature-omaria #optionsMenuItemEnt").hide(),$(".feature-omaria #logoutMenuItem, .feature-omaria #optionsMenuItem").show())},Le=function(e){var t=["extensionMenuItem","omariaMenuItem"];e&&e.attrs&&e.attrs.class&&(t=t.concat(e.attrs.class));var n=$.extend({},e.attrs,{class:t}),i=LPTools.createElement("li",n);return i.appendChild(LPTools.createElement("i",e.icon+" menuIcon")),i.appendChild(LPTools.createElement("span","name",e.name)),e.addMoreButton&&i.appendChild(LPTools.createElement("div","more")),n.childView&&$(i).bind("click",st),e.onClick&&$(i).bind("click",e.onClick),i},xe=function(e,t){switch(t&&K.applyFilter({showEmptyGroups:!1,func:function(e){return e instanceof GroupDisplay||e.getRecordType()===t}}),K.rebuildItems(n,!e.originalEvent.isTrusted),t){case"Account":et(K,"Empty_Site_Omaria",Strings.translateString("You can save and fill usernames and passwords for any website or app."),Strings.translateString("Add a password"),t);break;case"Generic":et(K,"Empty_Note_Omaria",Strings.translateString("Use a secure note to save important documents in your LastPass vault."),Strings.translateString("Add a secure note"),t);break;case"Address":et(K,"Empty_Address_Omaria",Strings.translateString("Add an address to auto-fill your email, phone number, and other contact info."),Strings.translateString("Add an address"),t);break;case"Credit Card":et(K,"Empty_Credit_Card_Omaria",Strings.translateString("Next time you go shopping, they'll be waiting!"),Strings.translateString("Add a payment card"),t);break;case"Bank Account":et(K,"Empty_Bank_Account_Omaria",Strings.translateString("Save and fill your bank accounts securely on any device with LastPass."),Strings.translateString("Add a bank account"),t)}},Se=function(s){var r=LPProxy.getRecordConfig(),l=LPProxy.getAllModelTypes();f.empty(),$("#addItem").addClass("divider"),b.empty(),r.viewConfig.forEach(function(e){if(e.forEach(function(e){if("all"!==e){var a=LPProxy.getConfigViewObject(e);a.types.forEach(function(e){var t=LPProxy.getConfigTypeObject(e),n=bg.get("g_prefoverrides").noformfill?bg.get("g_prefoverrides").noformfill:[],i=LPProxy.getAllModelTypes().includes(t.recordType);if("cloud-apps"!==e&&"CloudApps"!==e&&(i||"Password"===e||!n.includes("0")&&!n.includes(t.enterprisePolicyId))){(a.default||l.includes(t.recordType))&&b.append(Le({attrs:{class:"omariaItem",childView:"omariaItems"},name:Strings.translateString(a.name),icon:r.icons[t.id],addMoreButton:!0,onClick:function(e){xe(e,t.recordType)}}));var n=bg.get("g_prefoverrides").noformfill?bg.get("g_prefoverrides").noformfill:[];if("Password"===t.id||!n.includes("0")&&!n.includes(t.enterprisePolicyId)){var o=null;t.recordType===r.TYPE.Custom?0<s&&(o=Le({attrs:{class:"addOmariaItem",childView:"addCustomItems"},name:Strings.translateString(t.name),icon:r.icons[t.id],addMoreButton:!0,onClick:function(e){J.rebuildItems(p,!e.originalEvent.isTrusted)}})):o=Le({attrs:{class:"addOmariaItem"},name:Strings.translateString(t.name),icon:r.icons[t.id],onClick:function(){Te(t.recordType)}}),o&&f.append(o)}}})}}),e!==r.viewConfig[0]){if(!b[0].lastChild.classList.contains("omarSpacer")){var t=LPTools.createElement("li","omarSpacer");b.append(t)}var n=LPTools.createElement("li","omarSpacer");f.children().last().hasClass("omarSpacer")||f.append(n)}});var e=LPTools.createElement("li",{class:"extensionMenuItem addOmariaItem",value:"saveAll"},Strings.translateString("Save All Entered Data"));f.append(e),$('.addOmariaItem[value="saveAll"]').bind("click",function(){bg.lpevent("m_saed"),bg.get_selected_tab_data(null,function(e){bg.sendLpImprove("save_all_entered_data",{domain:bg.lp_gettld_url(e.url)})}),bg.saveall()})},we=function(){var e=K.getItemChildren(),t=[];e.forEach(function(e){e._model.isFavorite()&&t.push(e._model.newDisplayObject())}),0<t.length?(I.show(),$("#omarFavoritesMenuItem").show(),l.removeClass("noFavorites")):($("#omarFavoritesMenuItem").hide(),l.addClass("noFavorites"),I.hide())},Te=function(e){bg.lpevent("m_add"),"Account"===e?bg.get_selected_tab_data_no_extension(null,function(e){Ge({defaultData:{url:e?e.url:""}})}):Ke({defaultData:{notetype:e}})},Ce=function(){P.LP_removeAttr("style"),_.LP_removeAttr("style"),T.LP_removeAttr("style"),bg.is_user_debug_enabled()&&P.show(),bg.have_binary()&&bg.LPPlatform.isWin()&&_.show(),LPTools.hasProperties(bg.get("g_applications"))&&T.show(),LPFeatures.allowNotes()?$("#notesMenuItem").show():$("#notesMenuItem").hide()},ke=function(e){if(e.isOmarSet&&(c=a.getElementById("omarIdentitiesMenuItem")),G=LPProxy.getIdentities(),LPProxy.enableCurrentIdentity(G),0<G.length){Re(V);for(var t=[],n=0,i=G.length;n<i;++n)t.push(G[n].newDisplayObject());var o;new IdentityContainer(t,e).initialize(a.getElementById("identities"))}else $(c).hide()},Me=function(e){return!0===re[e]},De=function(e,t){var n=function(e){var t=bg.lpmdec(e.extra,!0),n=/Language:(.+)/.exec(t);return n&&1<n.length?n[1].substr(0,2):"en"},i=[],o=[],a,s;for(a=0,s=le.length;a<s;++a){var r=LPProxy.getNoteModel(le[a].aid);if(r){var l=n(r._data);-1===o.indexOf(l)&&o.push(l)}}for(a=0,s=le.length;a<s;++a){var c=le[a].aid;if("account"===le[a].type)i.push(new MatchingAccountDisplay(LPProxy.getSiteModel(c)));else if("note"===le[a].type){var p=LPProxy.getNoteModel(c);i.push(new MatchingNoteDisplay(p,1<o.length?n(p._data):null))}}(te=new Container(i,t)).setElement(e),te.rebuildItems()},$e=function(e){for(var t=0,n=(le=bg.getmatchingsites(!1,!0,!1)).length;t<n;++t)re[le[t].aid]=!0;var i;e.isZiggySet||LPProxy.getPreference("toplevelmatchingsites",!1)?(l.addClass("matchingSitesIsVisible"),g.addClass("divider"),d.removeClass("hidden"),2<le.length?(g.addClass("topLevelMatchesShadow"),$("#allMatchingSiteCounter").text(le.length),m.removeClass("hidden")):(g.removeClass("topLevelMatchesShadow"),0===le.length&&(g.removeClass("divider"),l.removeClass("matchingSitesIsVisible"),d.addClass("hidden"),m.addClass("hidden"))),Ue("topLevelMatchingSites",function(){De(o,$.extend({},e,{autoExpandSingleItem:!1,moreOptionsElement:a.getElementById("matchingSites"),moreOptionsState:ue.TopLevelMatchingSitesState,addLastClass:!1,trackAction:!0,sortFunction:VaultItemBaseDisplay.prototype.sortOmarMatchingItems})),he()})()):(0===le.length?y.LP_removeAttr("style"):(y.show(),$("#matchingSiteCounter").text(le.length)),g.removeClass("divider"),g.removeClass("topLevelMatchesShadow"),l.removeClass("matchingSitesIsVisible"),d.addClass("hidden"))},Ae=function(){var e=bg.getClearRecentTime(),t=bg.Preferences.get("recentUsedCount"),n=null;(n=bg.get("LPContentScriptFeatures").omaria?K.getItemChildren():Y.getItemChildren().concat(j.getItemChildren())).sort(VaultItemBaseDisplay.prototype.sortByMostRecent);for(var i=[],o=0,a=n.length;o<a&&o<t;++o){var s=n[o];s.getLastTouchValue()>=e&&i.push(s._model.newDisplayObject())}0<i.length?(ee=new Container(i,$.extend({},M,{sortFunction:VaultItemBaseDisplay.prototype.sortByMostRecent,separateFavorites:!1}))).initialize(r):We(r)},Fe=function(){var e=K.getItemChildren(),t;t=[],e.forEach(function(e){e._model.isFavorite()&&t.push(e._model.newDisplayObject())}),0<t.length?(W=new Container(t,M,{sortFunction:VaultItemBaseDisplay.prototype.sortByNameAsc})).initialize(i):We(i)},Be=function(){LPTools.removeDOMChildren(s);for(var e=0,t=X.length;e<t;++e){var n=X[e],i=n.build(M);n.postBuild(i),s.appendChild(i)}if(0===X.length){var o=LPTools.buildEmptyPlaceholder(Strings.translateString("No Matching Results"),"extensionSearchPlaceholder",s);s.appendChild(o)}LPTools.addKeyBoardNavigation(s.children,{rightArrowSelector:".moreItem",selectFirst:!0,displayItems:X}),H()},Oe=(Ne=null,function(e){0<e.length?(ie&&(X&&X.forEach(function(e){e.hideInContextOptions()}),X=Q.getSearchResultItems(e),Be()),ne||(je("search",{applyKeyboardNav:!1,onPop:function(){w.val("")}}),ne=!0,bg.sendLpImprove("search",{source:"icon"}))):Ne&&0<Ne.length&&(Ze(),ne=!1),Ne=e,H()}),Ne,Re=function(e){var t=Strings.translateString("Identities")+" ("+e.getName()+")",n=c.firstChild;3!==n.nodeType?(n=a.createTextNode(t),c.insertBefore(n,c.firstChild)):n.textContent=t},Ue=function(i,o){return function(){var e=this,t=arguments,n=function(){o.apply(e,t)};ie?n():ce[i]=n}},ze=function(e){e&&(e.stopPropagation(),e.preventDefault())},He=function(e){for(var t=null;null!==e&&null===(t=e.getAttribute("childview"));)e=e.parentElement;return t},Ve=function(e){return(e=e||{}).saveOptions={source:"icon"},e},Ge=function(e){bg.LPPlatform.openTabDialog("site",Ve(e))},Ke=function(e){bg.LPPlatform.openTabDialog("note",Ve(e))},Ye=function(e){bg.LPPlatform.openTabDialog("formFill",Ve(e))},We=function(e){e.appendChild(LPTools.createElement("li","extensionMenuItem none",bg.gs("None Available")))},je=function(e,t){pe.push(new ue.CSSState(e,t)),H()},Ze=function(e){var t=pe.pop();t&&t.pop(e),H()},qe=dialogs.generatePassword,Xe=function(){qe.getDialog().close(),h.unbind("click",Xe)},Qe=null,Je=function(){!0===bg.get("LPContentScriptFeatures").better_generate_password_enabled&&(qe=dialogs.betterGeneratePassword),qe.open({preSetup:function(e){if(null===Qe){var t=qe.parentElementID,n=e.options.hideHeader,i=e.dynamicHeight;Qe=function(){qe.parentElementID=t,e.options.hideHeader=n,e.useDynamicHeignt(i)}}qe.parentElementID="extensionDropdownGeneratePassword",e.options.hideHeader=!0,e.useDynamicHeignt(!1)},postSetup:function(){H()},onClose:function(){Ze()},onCopy:function(){LPPlatform.closePopup(!0)},saveOptions:{source:"icon"}}),h.unbind("click",Xe),h.bind("click",Xe)},et=function(e,t,n,i,o){if(o=o||"Generic",e.isEmpty()){var a=LPTools.createElement("div","emptyView");a.appendChild(LPTools.createElement("img",{src:"images/vault_4.0/"+t+".png",class:"emptyViewIcon"})),a.appendChild(LPTools.createElement("h1","emptyViewText",n));var s=LPTools.createElement("input",{class:"addItem rbtn",type:"button",value:i,tabindex:-1});s.appendChild(LPTools.createElement("i","fa fa-trash")),a.appendChild(s),s.addEventListener("click",function(e){Te(o)}),LPTools.addKeyBoardNavigation($(s),{selectFirst:!0}),document.getElementById("items").appendChild(a)}},tt=function(e,t,n){if(e.isEmpty()){var i=LPTools.createElement("div","emptyView");i.appendChild(LPTools.createElement("img",{src:"images/vault_4.0/"+t,class:"emptyViewIcon"})),i.appendChild(LPTools.createElement("h1","emptyViewText",n)),document.getElementById("items").appendChild(i)}},nt=function(){bg.LPPartner&&bg.LPPartner.getPartnerInfo&&bg.LPPartner.getPartnerInfo(function(e){e&&($(s).addClass("partner-logo"),k.attr("src",e.logoUrl).removeClass(e.class).addClass(e.class),C.show(),l.addClass("partner"),H())})},it=dialogs.siteFeedback,ot=function(){it.getDialog().resetPage(),it.getDialog().close(),h.unbind("click",ot),h.bind("click",Ze)},at=function(){it.open({preSetup:function(e){it.parentElementID="siteFeedback",e.options.hideHeader=!0,e.useDynamicHeignt(!1)},postSetup:function(){H()},onClose:function(){Ze()}}),h.unbind("click",Ze),h.bind("click",ot)};w.LP_addSearchHandlers("inputDialog",function(e){Oe(e)}),h.bind("click",Ze);var st=function(e){je(He(e.target),{selectFirst:!e.originalEvent.isTrusted}),ze(e)};$("[childview]").bind("click",st),$("#addSite").bind("click",function(e){bg.get_selected_tab_data_no_extension(null,function(e){bg.lpevent("m_add"),Ge({defaultData:{url:e?e.url:""}}),LPPlatform.closePopup()}),e.stopPropagation()}),$("#saveAllEnteredData").bind("click",function(){bg.lpevent("m_saed"),bg.get_selected_tab_data(null,function(e){bg.sendLpImprove("save_all_entered_data")}),bg.saveall()}),$("#addNote").bind("click",function(){bg.lpevent("m_addn"),Ke()}),$("#addFormFill").bind("click",function(){bg.lpevent("m_af"),Ye()}),$("#addCreditCard").bind("click",function(){bg.lpevent("m_af"),Ye({defaultData:{profiletype:FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD}})}),$("#clearForms").bind("click",function(){bg.lpevent("m_clrf"),bg.clearforms("icon")}),$("#siteFeedbackMenuItem").bind("click",function(){bg.Preferences.set("hasClickedSiteFeedback",!0);var e={Item:"Site Feedback"};bg.LPModule.callService("Segment","sendTypedEvent",["ExtensionMenuItemClicked",e],function(e){e&&console.error(e)})});var rt=function(){var e={Item:"Account Options"};bg.LPModule.callService("Segment","sendTypedEvent",["ExtensionMenuItemClicked",e],function(e){e&&console.error(e)})};$("#optionsMenuItem").bind("click",function(){rt()}),$("#optionsMenuItemEnt").bind("click",function(){rt()});var lt=null,ct,pt,ut,dt;$("#chooseProfile").bind("click",function(){dialogs.chooseProfile.open({preSetup:function(e){if(null===lt){var t=dialogs.chooseProfile.parentElementID,n=e.options.hideHeader;lt=function(){dialogs.chooseProfile.parentElementID=t,e.options.hideHeader=n,e.$element.css("min-height","")}}e.$element.css("min-height",0),dialogs.chooseProfile.parentElementID="chooseProfileCreditCard",e.options.hideHeader=!0},onClose:function(){Ze()},saveOptions:{source:"icon"}})}),$("#vaultMenuItem").bind("click",function(){bg.lpevent("m_ov"),bg.openvault()}),$("#sitesMenuItem").bind("click",Ue("sites",function(e){Y.rebuildItems(n,!e.originalEvent.isTrusted),tt(Y,"Empty_Site.png",Strings.translateString("Remember every password"))})),$("#formFillsMenuItem").bind("click",Ue("formFills",function(e){Z.rebuildItems(n,!e.originalEvent.isTrusted),tt(Z,"Empty_Form.png",Strings.translateString("Fill Every Form"))})),$("#applicationsMenuItem").bind("click",Ue("applications",function(e){q.rebuildItems(n,!e.originalEvent.isTrusted),tt(q,"Empty_Site.png",Strings.translateString("Remember every password"))})),$("#generateMenuItem").bind("click",Je),$("#notesMenuItem").bind("click",Ue("notes",function(e){j.rebuildItems(n,!e.originalEvent.isTrusted),tt(j,"Empty_Note.png",Strings.translateString("Store Every Note"))})),$("#clearMostRecent").bind("click",function(){bg.clearrecent(),LPTools.removeDOMChildren(r),We(r)}),$("#siteFeedbackMenuItem").bind("click",at);var mt=Ue("mostRecent",function(e){oe||(Ae(),oe=!0),LPTools.addKeyBoardNavigation(r.children,{rightArrowSelector:".moreItem",selectFirst:!e.originalEvent.isTrusted,displayItems:ee?ee.getItems():null})});E.bind("click",mt);var gt=Ue("sites",function(e){bg.get("LPContentScriptFeatures").omaria&&!se&&(Fe(),se=!0,LPTools.addKeyBoardNavigation(i.children,{rightArrowSelector:".moreItem",selectFirst:!e.originalEvent.isTrusted,displayItems:W?W.getItems():null}))});I.bind("click",gt);var ft=Ue("matchingSites",function(e){ae||(De(t,M),ae=!0),LPTools.addKeyBoardNavigation(a.getElementById("matchingSites").children,{rightArrowSelector:".moreItem",selectFirst:!e.originalEvent.isTrusted})});y.bind("click",ft),m.bind("click",ft),$("#prefMenuItem").bind("click",function(){bg.lpevent("m_op"),bg.openprefs()}),$("#helpMenuItem").bind("click",function(){bg.lpevent("m_oh"),bg.openhelp()}),$("#adminConsoleMenuItem").bind("click",function(){bg.lpevent("m_oec"),bg.openentconsole()}),$("#logoutMenuItem, #optionsViewLogoutMenuItem").bind("click",function(){bg.sendLpImprove("logout_clicked",{source:"icon"}),bg.lpevent("m_lo"),bg.get("g_issafari_appext")&&($("#extensionDropdown").removeClass("panelIsActive"),$("#extensionDropdown").removeClass("expirationSet"),$("#notificationContainer").empty(),$("#panelContainer").empty()),bg.loggedOut(!1,"menu")}),$("#challengeMenuItem").bind("click",function(){bg.lpevent("m_sec"),bg.openseccheck()}),$("#favoritesMenuItem").bind("click",function(){bg.lpevent("m_of"),bg.openfavorites(!1,"icon")}),$("#aboutMenuItem").bind("click",function(){bg.lpevent("m_abt"),bg.openabout()}),P.bind("click",function(){bg.lpevent("m_dbgcon"),bg.opendebugtab()}),$("#csvExportMenuItem").bind("click",function(){bg.lpevent("m_e"),bg.openexport()}),$("#formFillExportMenuItem").bind("click",function(){bg.lpevent("m_eff"),bg.formfillexport()}),$("#encryptedExportMenuItem").bind("click",function(){bg.lpevent("m_elp"),bg.openlastpassexport()}),_.bind("click",function(){bg.lpevent("m_ewlan"),bg.wlanexport()}),$("#printSitesMenuItem").bind("click",function(){bg.lpevent("m_p"),bg.openprint(!1)}),$("#printNotesMenuItem").bind("click",function(){bg.lpevent("m_pn"),bg.openprint(!0)}),$("#refreshMenuItem").bind("click",function(){bg.lpevent("m_ref"),LPProxy.refreshSites()}),$("#clearCachMenuItem").bind("click",function(){bg.lpevent("m_cl"),bg.clearCache(!1,!0,!1)}),$("#myAccountMenuItem").bind("click",function(){bg.lpevent("m_mya"),bg.openmyaccount()}),$("#sessionsMenuItem").bind("click",function(){bg.lpevent("m_ses"),bg.opensessions()}),$(".extensionMenuItem").bind("click",function(){H()}),LPPlatform.addEventListener(window,"unload",function(){ht()}),l.on("click",".extensionMenuItem, .footer, .contextOptionsDropdown",function(){LPPlatform.closePopup()}),$("#omarChallengeMenuItem").bind("click",function(){bg.lpevent("m_sec"),bg.openseccheck()}),$("#omarFavoritesMenuItem").bind("click",function(){bg.lpevent("m_of"),bg.openfavorites(!1,"icon")}),$("#omarPrefMenuItem").bind("click",function(){bg.lpevent("m_op"),bg.openprefs()}),$("#omarHelpMenuItem").bind("click",function(){bg.lpevent("m_oh"),bg.openhelp()}),$("#omarAboutMenuItem").bind("click",function(){bg.lpevent("m_abt"),bg.openabout()}),$("#omarRefreshMenuItem").bind("click",function(){bg.lpevent("m_ref"),LPProxy.refreshSites()}),$("#omarClearCachMenuItem").bind("click",function(){bg.lpevent("m_cl"),bg.clearCache(!1,!0,!1)}),$("#omarSessionsMenuItem").bind("click",function(){bg.lpevent("m_ses"),bg.opensessions()}),$("#safariMessageButton").bind("click",function(){bg.openURL("https://lastpass.com/safariAppExtension.php?source=dropdown"),LPPlatform.closePopup()}),Topics.get(Topics.REFRESH_DATA).subscribe(function(){ye()}),Topics.get(Topics.PUSH_STATE).subscribe(function(e){pe.push(e)}),Topics.get(Topics.EDIT_SITE).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),Ge(e)}),Topics.get(Topics.EDIT_NOTE).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),Ke(e)}),Topics.get(Topics.EDIT_FORM_FILL).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),Ye(e)}),Topics.get(Topics.EDIT_APPLICATION).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),bg.LPPlatform.openTabDialog("application",e)}),Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(e){LPProxy.enableIdentity(e),V=e}),Topics.get(Topics.CONFIRM).subscribe(function(e){bt("confirmation",e)}),Topics.get(Topics.ERROR).subscribe(function(e){e&&bt("alert",{title:Strings.Vault.ERROR,text:e})}),Topics.get(Topics.REPROMPT).subscribe(function(e){bt("reprompt",{successCallback:e})}),Topics.get(Topics.LEFT_ARROW).subscribe(function(){LPTools.disableMouse(),Ze(!0)}),Topics.get(Topics.CLEAR_DATA).subscribe(function(){for(var e=pe.length-1;-1<e;--e)pe[e].pop();pe=[],LPTools.setNavIndex(0),w.val(""),se=ae=oe=ie=ne=!1,re={},ce={},le=null,Qe&&Qe(),lt&&lt(),x.removeClass("initialized"),bg.get("g_issafari_appext")&&($("#extensionDropdown").removeClass("panelIsActive"),$("#extensionDropdown").removeClass("expirationSet"),$("#notificationContainer").empty(),$("#panelContainer").empty()),b.empty(),f.empty(),Dialog.prototype.closeAllDialogs(!0)}),Topics.get(Topics.INITIALIZED).subscribe(function(){Strings.translate(a.body),LPPlatform.setupDropdownImportMenu(x)});var bt=function(e,t){$("#container").LP_hide(),LPTools.removeKeyBoardNavigation(),t=$.extend(t,{onResize:function(e,t){LPPlatform.setDropdownPopoverSize(e,t)},onClose:function(){LPPlatform.closePopup()}}),LPDialog.openDialog(e,t)},vt,ht=function(){Topics.get(Topics.CLEAR_DATA).publish()},Pt,_t=(yt=function(){bg.getData({context:"extensionDropdown",callback:function(){be()}})},Et={},It=function(e){LPPlatform.move(screenY-(e.screenY-Et.y),e.screenX-Et.x)},function(){D=!0,document.body.classList.add("quickSearch"),window.addEventListener("mousedown",function(e){e.target===document.getElementById("searchContainer")&&(Et.x=e.clientX,Et.y=e.clientY,window.addEventListener("mousemove",It),e.preventDefault())}),window.addEventListener("mouseup",function(){window.removeEventListener("mousemove",It)}),Topics.get(Topics.ESCAPE).subscribe(function(){LPPlatform.doClosePopup()}),Account.prototype.getDisplayClass=function(){return MatchingAccountDisplay},"undefined"!=typeof bg?yt():LPPlatform.initialize({context:"extensionDropdown",callback:yt})}),yt,Et,It;return{setup:be,State:ue,isMatchingSite:Me,setGroupLabel:de,open:function(){var e=bg.get("g_badgedata");if(e&&"notification"===e.cmd){switch(e.alerttype){case"duplicate":bt("duplicatePassword",{notification:e});break;case"weak":bt("weakPassword",{notification:e})}switch(e.type){case"error":bt("notification",{notification:bg.get("g_notification_data")});break;case"mpwchange":bt("securityNotice",{notification:bg.get("g_notification_data")});break;case"lpalert":bt("breachAlert",{notification:bg.get("g_notification_data")})}bg.clear_badge()}else e&&"migration"===e.cmd?(bt("migration",{notification:e}),bg.clear_badge()):be()},openDialog:bt,reset:ht,setBigIcons:function(e){bg.set("g_bigicons",e)},openQuickSearch:_t,setSize:H}}(document);
//# sourceMappingURL=sourcemaps/extensionDropdown.js.map
